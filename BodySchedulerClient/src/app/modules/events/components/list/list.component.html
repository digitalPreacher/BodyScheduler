<app-loader *ngIf="isLoading">
</app-loader>

<div class="d-flex justify-content-start mb-2 rounded-3 p-2 bg-dark create-event-button">
  <app-create></app-create>
  <div class="search-wrapper">
    <div class="search-box">
      <input type="text" #insertSearchField class="search-input form-control" (keyup)="filteringData(insertSearchField.value)" placeholder="Поиск...">
      <i class="bi bi-search search-icon"></i>
    </div>
  </div>
</div>
<div class="mt-3 rounded-3 p-2 bg-dark">
  <mdb-tabs class="table-list-events">
    <mdb-tab title="В процессе">
      <div class="table-responsive" *ngIf="!isFilter">
        <table class="table table-dark table-hover">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th>
                Название
              </th>
              <th>
                Описание
              </th>
              <th>
                Начало
              </th>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody *ngFor="let event of inProgressEvents | slice: (progressEventsPage - 1) * pageSize : progressEventsPage * pageSize; let i=index">
            <tr>
              <td> {{ (progressEventsPage - 1) * pageSize + i + 1 }}</td>
              <td class="limit-text"> {{ event.title }} </td>
              <td class="limit-text"> {{ event.description }} </td>
              <td> {{ event.start | date : "M/d/yy"}} </td>
              <td *ngIf="userRole != 'Admin'"><app-edit [eventId]="event.id"></app-edit></td>
              <td><app-copy [eventId]="event.id"></app-copy></td>
              <td><app-details [eventId]="event.id"></app-details></td>
              <td><app-delete [eventId]="event.id"></app-delete></td>
            </tr>
          </tbody>
        </table>
        <ngb-pagination [collectionSize]="collectionProgressEventsSize" [(page)]="progressEventsPage" [boundaryLinks]="true"
                        [pageSize]="pageSize" class="d-flex justify-content-center"></ngb-pagination>

      </div>
      <div class="table-responsive" *ngIf="isFilter">
        <table class="table table-dark table-hover">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th>
                Название
              </th>
              <th>
                Описание
              </th>
              <th>
                Начало
              </th>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody *ngFor="let event of filteringinProgressEvents | slice: (progressEventsPage - 1) * pageSize : progressEventsPage * pageSize; let i=index">
            <tr>
              <td> {{ (progressEventsPage - 1) * pageSize + i + 1 }}</td>
              <td class="limit-text"> {{ event.title }} </td>
              <td class="limit-text"> {{ event.description }} </td>
              <td> {{ event.start | date : "M/d/yy"}} </td>
              <td *ngIf="userRole != 'Admin'"><app-edit [eventId]="event.id"></app-edit></td>
              <td><app-copy [eventId]="event.id"></app-copy></td>
              <td><app-details [eventId]="event.id"></app-details></td>
              <td><app-delete [eventId]="event.id"></app-delete></td>
            </tr>
          </tbody>
        </table>
        <ngb-pagination [collectionSize]="collectionFilterProgressEventsSize" [(page)]="progressEventsPage" [boundaryLinks]="true"
                        [pageSize]="pageSize" class="d-flex justify-content-center"></ngb-pagination>

      </div>
    </mdb-tab>
    <mdb-tab title="Завершены">
      <div class="table-responsive" *ngIf="!isFilter">
        <table class="table table-dark table-hover">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th>
                Название
              </th>
              <th>
                Описание
              </th>
              <th>
                Начало
              </th>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody *ngFor="let event of completedEvents | slice: (completedEventsPage - 1) * pageSize : completedEventsPage * pageSize; let j=index">
            <tr>
              <td> {{ (completedEventsPage - 1) * pageSize + j + 1 }}</td>
              <td class="limit-text"> {{ event.title }} </td>
              <td class="limit-text"> {{ event.description }} </td>
              <td> {{ event.start | date : "M/d/yy"}} </td>
              <td *ngIf="userRole != 'Admin'"><app-edit [eventId]="event.id"></app-edit></td>
              <td><app-copy [eventId]="event.id"></app-copy></td>
              <td><app-details [eventId]="event.id"></app-details></td>
              <td><app-delete [eventId]="event.id"></app-delete></td>
            </tr>
          </tbody>
        </table>

        <ngb-pagination [collectionSize]="collectionCompletedEventsSize" [(page)]="completedEventsPage" [boundaryLinks]="true"
                        [pageSize]="pageSize" class="d-flex justify-content-center"></ngb-pagination>
      </div>
      <div class="table-responsive" *ngIf="isFilter">
        <table class="table table-dark table-hover">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th>
                Название
              </th>
              <th>
                Описание
              </th>
              <th>
                Начало
              </th>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody *ngFor="let event of filteringCompleteEvents | slice: (completedEventsPage - 1) * pageSize : completedEventsPage * pageSize; let j=index">
            <tr>
              <td> {{ (completedEventsPage - 1) * pageSize + j + 1 }}</td>
              <td class="limit-text"> {{ event.title }} </td>
              <td class="limit-text"> {{ event.description }} </td>
              <td> {{ event.start | date : "M/d/yy"}} </td>
              <td *ngIf="userRole != 'Admin'"><app-edit [eventId]="event.id"></app-edit></td>
              <td><app-copy [eventId]="event.id"></app-copy></td>
              <td><app-details [eventId]="event.id"></app-details></td>
              <td><app-delete [eventId]="event.id"></app-delete></td>
            </tr>
          </tbody>
        </table>

        <ngb-pagination [collectionSize]="collectionFilterCompletedEventsSize" [(page)]="completedEventsPage" [boundaryLinks]="true"
                        [pageSize]="pageSize" class="d-flex justify-content-center"></ngb-pagination>
      </div>
    </mdb-tab>
  </mdb-tabs>
</div>

<app-error-modal #errorModal></app-error-modal>
